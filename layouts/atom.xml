{{ printf "<?xml version=\"1.0\" encoding=\"utf-8\" standalone=\"no\"?>" | safeHTML }}
{{- /* 去掉首尾空白 */ -}}
{{- $pages := .Site.RegularPages -}}
{{- $limit := .Site.Config.Services.RSS.Limit -}}
{{- if ge $limit 1 }}{{ $pages = $pages | first $limit }}{{ end -}}
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="{{ .Site.LanguageCode | default "en-us" }}">
  <title>{{ .Site.Title | htmlEscape }}</title>
  <link href="{{ .Site.BaseURL }}"/>
  <link href="{{ .Permalink }}" rel="self"/>
  <id>{{ .Site.BaseURL | strings.TrimSuffix "/" }}</id>
  <subtitle>{{ .Site.Params.description | default .Site.Title | htmlEscape }}</subtitle>
  <updated>{{ now.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}</updated>

  {{/* 单作者站点，所有 entry 共用 */}}
  <author>
    <name>{{ .Site.Params.author | default .Site.Title | htmlEscape }}</name>
    {{ with .Site.Params.email }}<email>{{ . | htmlEscape }}</email>{{ end }}
  </author>

  {{- range $pages -}}
  <entry>
    <title>{{ .Title | htmlEscape }}</title>
    <link href="{{ .Permalink }}"/>
    <id>{{ .Permalink }}</id>
    <published>{{ .Date.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}</published>
    <updated>{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | safeHTML }}</updated>

    {{ $full := site.Params.feedFull | default false }}

    {{ if $full }}
      <content type="html">{{ printf "<![CDATA[%s]]>" .Content | safeHTML }}</content>
    {{ else }}
      <summary type="html">{{ printf "<![CDATA[%s]]>" .Summary | safeHTML }}</summary>
    {{ end }}
  </entry>
  {{- end -}}
</feed>